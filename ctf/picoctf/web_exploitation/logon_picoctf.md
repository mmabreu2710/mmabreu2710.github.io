
# Challenge "Logon" Writeup

## Vulnerability: Cookie-Based Privilege Escalation

### Where: Insecure handling of user authentication via cookies

### Impact: The challenge demonstrates how manipulating cookie values can escalate privileges from a normal user to an admin.

**NOTE**: The challenge involves logging in as a normal user and then escalating privileges by modifying the `admin` cookie value.

## Steps to reproduce:

1. **Login as a Normal User:**
   I attempted to log in as a normal user, for example `peter`. Interestingly, the system did not verify the password and allowed me to log in, but only as a normal user (not an admin).

2. **Inspect Cookies:**
   After logging in as `peter`, I inspected the cookies using Burp Suite and noticed the following cookie values:

   ```
   Cookie: password=s; username=peter; admin=False
   ```

3. **Modify the `admin` Cookie:**
   I modified the `admin` cookie value from `False` to `True`:

   ```
   Cookie: password=s; username=peter; admin=True
   ```

4. **Retrieve the Flag:**
   After modifying the cookie, I refreshed the page and was granted administrator privileges. The system displayed the flag:

   ```
   Flag: picoCTF{th3_c0nsp1r4cy_l1v3s_d1c24fef}
   ```

## Conclusion:

By manipulating the `admin` cookie value from `False` to `True`, I was able to escalate privileges to an admin user and retrieve the flag, completing the challenge.