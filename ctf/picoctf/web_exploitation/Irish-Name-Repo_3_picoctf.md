# Challenge "Irish-Name-Repo 3" Writeup

## Vulnerability: SQL Injection with ROT13 Encoding

### Where: Admin login page with SQL injection vulnerability in password field

### Impact: This challenge demonstrates how SQL injection can bypass authentication, especially when combined with encoding mechanisms like ROT13, to reveal the flag.

**NOTE**: The challenge involves using SQL injection with a ROT13-encoded payload to bypass the login check.

## Steps to reproduce:

1. **Explore the Admin Login Page**:
   - On the main page, we found an "Admin Login" option within the menu. This page has a login form that requires only a password to access the admin area.

2. **Inspect the Login Request**:
   - Using Burp Suite, we intercepted the request sent by the form, which is a POST request to `login.php`. The request contains two parameters: the password and a `debug` value set to `0`.

   - By setting `debug=1` and resending the request, we saw the SQL query used in the backend displayed on the page, confirming that SQL injection could be used to bypass authentication.

3. **Detect ROT13 Encoding**:
   - Testing with different passwords revealed that any input sent was ROT13-encoded before being processed by the SQL query. For instance:
     - Sending `"adminpass"` as a password resulted in `"nzqvaznff"` in the query.
   
   - This confirmed that ROT13 encoding was applied to all characters in the input, while numbers remained unchanged.

4. **Construct the Payload**:
   - To bypass the login, we crafted a SQL injection payload: `" ' or 1=1 -- "`.
   - Applying a ROT13 shift to this payload resulted in `" ' be 1=1 -- "`.

5. **Send the ROT13-Encoded Payload**:
   - Using the encoded payload (`' be 1=1 --`), we successfully bypassed the login check and accessed the admin page, which displayed the flag.

6. **Retrieve the Flag**:
   The page displayed the flag:

   ```
   picoCTF{m0R3_SQL_plz_fa983901}
   ```

## Conclusion:

By encoding an SQL injection payload with ROT13, we bypassed the authentication mechanism, accessed the admin page, and retrieved the flag, successfully completing the challenge.
