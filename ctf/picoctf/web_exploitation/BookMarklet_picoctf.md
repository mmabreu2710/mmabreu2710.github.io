
# Challenge "Bookmarklet" Writeup

## Vulnerability: Client-Side Decryption of an Encrypted Flag

### Where: Decryption using a hardcoded key and encrypted data within JavaScript code

### Impact: The challenge aimed to test the ability to execute JavaScript code within the browser console to decrypt an encrypted flag.

**NOTE**: The challenge involved understanding a piece of JavaScript code that performed decryption using a predefined key and encrypted data.

## Steps to reproduce:

1. **Analyze the JavaScript Code:** I was provided with the following JavaScript code in the challenge description:

```javascript
javascript:(function() {
    var encryptedFlag = "àÒÆÞ¦È¬ëÙ£ÖÓÚåÛÑ¢ÕÓ¡ÒÅ¤í";
    var key = "picoctf";
    var decryptedFlag = "";
    for (var i = 0; i < encryptedFlag.length; i++) {
        decryptedFlag += String.fromCharCode((encryptedFlag.charCodeAt(i) - key.charCodeAt(i % key.length) + 256) % 256);
    }
    alert(decryptedFlag);
})();
```

2. **Identify the Key and Encryption Logic:** The code used a hardcoded key `"picoctf"` and decrypted the `encryptedFlag` by iterating over each character and modifying its ASCII value using the key.

3. **Run the Code in the Browser Console:** I copied the entire code and pasted it into the browser's developer console, executing the decryption process.

4. **Retrieve the Flag:** Once executed, the code displayed the decrypted flag through an alert:

```
picoCTF{p@g3_turn3r_0148cb05}
```

## Conclusion:

By running the provided JavaScript code in the browser console, I was able to decrypt the flag successfully and complete the challenge.