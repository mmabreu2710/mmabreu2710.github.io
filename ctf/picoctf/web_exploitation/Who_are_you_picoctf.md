# Challenge "Who are you" Writeup

## Vulnerability: HTTP Header Manipulation

### Where: Access restricted based on HTTP request headers

### Impact: This challenge demonstrates how HTTP headers can control access to resources on a website. By modifying specific headers, we can bypass access restrictions to retrieve the flag.

**NOTE**: The challenge involves iteratively modifying HTTP headers according to server responses until access is granted.

## Steps to reproduce:

1. **Initial Access - Modify the User-Agent Header**:
   The initial page displays a message saying, "Only people who use the official PicoBrowser are allowed on this site!" indicating that we need to modify the `User-Agent` header.

   - **User-Agent**: Set to `PicoBrowser`

   After setting this header, the page updates to say, "I don't trust users visiting from another site."

2. **Referer Header**:
   The next message indicates we need to modify the `Referer` header to match the pageâ€™s URL.

   - **Referer**: Set to `http://mercury.picoctf.net:39114/`

   After setting the `Referer` header, we see a new message: "Sorry, this site only worked in 2018."

3. **Date Header**:
   The site requires the `Date` header to be set to the year 2018.

   - **Date**: Set to `2018`

   After adding this header, the message updates to: "I don't trust users who can be tracked."

4. **DNT (Do-Not-Track) Header**:
   To satisfy this requirement, we set the `DNT` header to request "Do Not Track."

   - **DNT**: Set to `1`

   The site then changes to: "This website is only for people from Sweden."

5. **X-Forwarded-For Header**:
   To make the request appear to originate from Sweden, we add the `X-Forwarded-For` header with a Swedish IP address.

   - **X-Forwarded-For**: Set to `2.16.66.0`

   The next message states, "You're in Sweden but you don't speak Swedish?"

6. **Accept-Language Header**:
   To indicate that we "speak" Swedish, we add the `Accept-Language` header with a value for the Swedish language.

   - **Accept-Language**: Set to `sv`

   After sending this request, the website finally grants access and reveals the flag.

7. **Retrieve the Flag**:
   The final request with all modified headers displays the flag:

   ```
   picoCTF{http_h34d3rs_v3ry_c0Ol_6e30d475}
   ```

## Conclusion:

By modifying HTTP request headers according to each hint on the page, we were able to bypass all access restrictions and retrieve the flag, successfully completing the challenge.
