# Challenge "WebGauntlet 2" Writeup

## Vulnerability: SQL Injection and Session-Based Logic Bypass

### Where: SQL injection on login page and accessing `filter.php`

### Impact: This challenge demonstrates how SQL injection can bypass login authentication filters and manipulate session values to reveal sensitive information, such as the flag.

**NOTE**: The challenge involves using SQL injection to log in as an admin and then viewing a restricted page, `filter.php`, which displays the flag.

## Steps to reproduce:

1. **Perform SQL Injection on the Login Page**:
   The challenge provided specific SQL injection values:

   - **Username**: `ad'||'min`
   - **Password**: `a' IS NOT 'b`

   This login attempt bypasses the usual authentication checks by using SQL injection to manipulate the query logic.

2. **Access the `filter.php` Page**:
   After successfully logging in, we were directed to check `filter.php` for additional information. Upon visiting:

   ```
   http://mercury.picoctf.net:26215/filter.php
   ```

   We initially saw only the filtering logic, which displayed a list of SQL keywords and characters filtered by the application:

   ```
   Filters: or and true false union like = > < ; -- /* */ admin
   ```

3. **Refresh the `filter.php` Page**:
   - The `filter.php` code shows a session variable `$win` is set to `1` when the SQL injection is successful.
   - When `$win === 1`, `filter.php` calls `highlight_file("filter.php")`, displaying the source code along with the flag. We ensured not to refresh the page after the flag appeared, as the session resets `$win` to `0`.

4. **Retrieve the Flag**:
   Refreshing `filter.php` correctly displayed the flag embedded in the source code:

   ```
   picoCTF{0n3_m0r3_t1m3_fc0f841ee8e0d3e1f479f1a01a617ebb}
   ```

## Conclusion:

By using SQL injection on the login page and then accessing `filter.php`, we were able to trigger the session-based flag reveal, successfully completing the challenge.
