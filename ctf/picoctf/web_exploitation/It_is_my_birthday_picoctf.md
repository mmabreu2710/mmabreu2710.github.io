# Challenge "It is my Birthday" Writeup

## Vulnerability: MD5 Hash Collision

### Where: File upload page with MD5 hash-based validation for “invite” authenticity

### Impact: This challenge demonstrates how the MD5 hash function can be exploited by crafting two different files with the same hash (hash collision), allowing bypass of security measures based on MD5.

**NOTE**: MD5 is a weak hash function vulnerable to collisions, where two different files can produce the same hash value.

## Steps to reproduce:

1. **Challenge Analysis**:
   The challenge requires uploading two PDF files that meet the following conditions:
   - Both files must have the same MD5 hash.
   - Both files must be different in content.
   - Each file must be recognized as a PDF and not exceed the size limit of 18 KB.

2. **Finding an MD5 Collision**:
   - MD5 collisions are files with different contents but the same MD5 hash.
   - The description hints at a known MD5 collision method with files `hello.exe` and `erase.exe`, which share the same MD5 hash but have different contents.

3. **Convert Executables to PDF Files**:
   - We renamed `hello.exe` and `erase.exe` to `hello.pdf` and `erase.pdf` to satisfy the file type requirement.
   - Although they are not actual PDF documents, this simple renaming convinces the server they are PDFs based on file extension.

4. **Upload the Files**:
   - We uploaded `hello.pdf` and `erase.pdf` through the form on the website.
   - This submission met all requirements: both files are different, recognized as PDFs, and have identical MD5 hashes.

5. **Retrieve the Flag**:
   - Upon successful upload, the page validated our files, displaying the contents of `index.php`.
   - Within the source code of `index.php`, we found the flag embedded:

   ```
   picoCTF{c0ngr4ts_u_r_1nv1t3d_da36cc1b}
   ```

## Conclusion:

By leveraging an MD5 hash collision, we bypassed the security checks on the invite files, revealing the flag and completing the challenge.
