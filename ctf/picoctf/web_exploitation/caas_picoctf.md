# Challenge "CaaS" Writeup

## Vulnerability: Command Injection in Node.js `exec` Function

### Where: `/cowsay/:message` endpoint using unvalidated user input in command execution

### Impact: This challenge demonstrates how unvalidated input in the `exec` function can allow command injection, leading to unauthorized access to files, such as retrieving the flag.

**NOTE**: The challenge involves exploiting a command injection vulnerability by injecting shell commands into a parameter used by the `exec` function in Node.js.

## Steps to reproduce:

1. **Analyze the Command Injection Point**:
   The application executes the `cowsay` command with the user-provided `message` parameter in the URL. The `message` parameter was found to be vulnerable to command injection by appending shell commands with `;` (command separator).

2. **Attempt Command Injection**:
   We crafted a URL to list files in the directory, using `ls` as an injected command:

   ```
   https://caas.mars.picoctf.net/cowsay/ls;ls
   ```

   This returned a list of files in the directory, including `falg.txt`, which looked like a typo for `flag.txt`.

3. **Read the Flag File**:
   After identifying `falg.txt`, we crafted another URL to read its contents:

   ```
   https://caas.mars.picoctf.net/cowsay/ls;cat%20falg.txt
   ```

   This command returned the flag:

   ```
   picoCTF{moooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo0o}
   ```

4. **Conclusion**:
   By exploiting command injection, we bypassed restrictions and retrieved the flag from `falg.txt`, completing the challenge.
