# Challenge "picobrowser" Writeup

## Vulnerability: User-Agent Header Manipulation

### Where: HTTP User-Agent header check to restrict access based on browser type

### Impact: This challenge demonstrates how modifying HTTP headers can bypass browser-based restrictions to reveal the flag.

**NOTE**: The challenge involves changing the `User-Agent` header to simulate accessing the site with a specific browser type.

## Steps to reproduce:

1. **Access the Page**:
   - Navigating to the provided link displays a button labeled "flag."
   - Upon clicking the button, the page responds with: 
   
   ```
   You're not picobrowser! Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36
   ```
   
   This message indicates that the server checks the `User-Agent` header to confirm if the request comes from a specific browser named `picobrowser`.

2. **Modify the User-Agent Header**:
   - Using a tool like BurpSuite, we modified the `User-Agent` header in the request to match the required value:
   
     **Original Header**:
     ```
     User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.6533.100 Safari/537.36
     ```
   
     **Modified Header**:
     ```
     User-Agent: picobrowser
     ```

3. **Retrieve the Flag**:
   - With the `User-Agent` header set to `picobrowser`, we clicked the "flag" button again.
   - This time, the server returned the flag:

   ```
   picoCTF{p1c0_s3cr3t_ag3nt_e9b160d0}
   ```

## Conclusion:

By changing the `User-Agent` header to simulate the `picobrowser` user agent, we bypassed the restriction and successfully retrieved the flag, completing the challenge.
