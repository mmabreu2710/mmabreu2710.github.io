# Challenge "MatchTheRegex" Writeup

## Vulnerability: Regular Expression Matching

### Where: Input validation on the `/flag` endpoint

### Impact: This challenge demonstrates how understanding and matching a specific regular expression can be used to retrieve a flag.

**NOTE**: The challenge involves constructing an input that matches a given regular expression pattern, which then allows access to the flag.

## Steps to reproduce:

1. **Analyze the JavaScript Code**:
   In the webpage's script, we found the following function:

   ```
   function send_request() {
       let val = document.getElementById("name").value;
       // ^p.....F!?
       fetch(`/flag?input=${val}`)
           .then(res => res.text())
           .then(res => {
               const res_json = JSON.parse(res);
               alert(res_json.flag)
               return false;
           })
       return false;
   }
   ```

   The comment in the code, `^p.....F!?`, indicates a specific pattern for the input:
   - `^` - The string must start with this pattern.
   - `p` - The first character must be "p".
   - `.....` - Any five characters can follow.
   - `F` - The seventh character must be "F".
   - `!?` - The string may end with an exclamation mark, but it is optional.

2. **Construct a Matching Input**:
   We used the pattern requirements to build an input that satisfies these conditions. The example input `p12345F!` matches the pattern exactly.

3. **Submit the Input**:
   Entering `p12345F!` in the `name` input field and submitting triggered the `send_request()` function, which matched the regex and returned the flag via an alert.

4. **Retrieve the Flag**:
   Upon successful submission, the alert displayed the flag:

   ```
   picoCTF{y0u_kn0w_y0ur_r3geX_12345}
   ```

## Conclusion:

By analyzing and matching the specified regular expression, we were able to create a valid input and retrieve the flag, completing the challenge.
